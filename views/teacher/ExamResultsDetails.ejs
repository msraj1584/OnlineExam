<%- include('../partials/header', { title: 'Exam Result Details' }) %>
<%- include('../partials/navbar', { user: user }) %>
<div class="container mt-4">
    <main class="content">
        <div class="text-center mb-4">
            <h2 class="text-primary font-weight-bold">Exam: <%= exam.title %></h2>
        </div>
        <div class="d-flex justify-content-between align-items-center mb-4">
          <a href="/teacher/exam-results/<%= exam._id %>" class="btn btn-secondary">Back to Exam Result Details</a>
          <h3 class="text-secondary">Student: <%= result.student.firstName + ' ' + result.student.lastName %></h3>
        </div>
        <div class="mb-4">
            <p><strong>Score:</strong> <%= result.score %> / <%= result.totalQuestions %></p>
            <p><strong>Percentage:</strong> 
                <span class="<%= ((result.score / result.totalQuestions) * 100) >= 50 ? 'text-success' : 'text-danger' %>">
                    <%= ((result.score / result.totalQuestions) * 100).toFixed(2) %> %
                </span>
            </p>
        </div>
        <h3 class="mt-4 text-secondary">Question-wise Answers</h3>
        <div class="table-responsive mt-3">
            <table class="table table-bordered table-hover cell-border">
                <thead class="thead-dark text-center">
                    <tr>
                        <th style="width: 10%;">#</th>
                        <th>Question</th>
                        <th>Correct Answer</th>
                        <th>Student's Answer</th>
                        <th style="width: 15%;">Result</th>
                    </tr>
                </thead>
                <tbody>
                    <% result.answers.forEach((answer, index) =>  { %>
                        <tr>
                            <td class="text-center"><%= index + 1 %></td>
                            <td><%= answer.question.question %></td>
                            <td><%= answer.question.options[answer.question.correctAnswer] %></td>
                            <td><%= answer.question.options[answer.selectedAnswer] %></td>
                            <td class="text-center <%= answer.selectedAnswer === answer.question.correctAnswer ? 'bg-success text-white' : 'bg-danger text-white' %>">
                                <%= answer.selectedAnswer === answer.question.correctAnswer ? 'Correct' : 'Incorrect' %>
                            </td>
                        </tr>
                    <% }) %>
                </tbody>
            </table>
        </div>
    </main>
</div>
<%- include('../partials/footer') %>
